<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RPS Card Duel - Multiplayer</title>
  <style>
    @font-face {
      font-family: 'Antaresia';
      src: url('antaresia.otf') format('opentype');
    }

    @font-face {
      font-family: 'Luxembourg';
      src: url('LUXEMBOU.otf') format('opentype');
    }

    body {
      background: radial-gradient(ellipse at center, #2d5a2d 0%, #1a3d1a 70%, #0d2b0d 100%);
      font-family: 'Luxembourg', Arial, sans-serif;
      color: #fff;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: filter 0.3s ease;
    }

    body.blur-background .poker-table::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(3px);
      z-index: 100;
      pointer-events: none;
    }

    .poker-table {
      background: radial-gradient(ellipse at center, #0f4a0f 0%, #0a3a0a 100%);
      border: 12px solid #8B4513;
      width: 100vw;
      height: 100vh;
      position: relative;
      box-shadow: 
        inset 0 0 50px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: 40px;
    }

    .poker-table::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 20px;
      right: 20px;
      bottom: 20px;
      border: 3px solid #654321;
      pointer-events: none;
    }

    /* Lobby Screen */
    .lobby {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.95);
      padding: 50px;
      border-radius: 20px;
      border: 3px solid #FFD700;
      text-align: center;
      z-index: 1002;
      box-shadow: 0 0 50px rgba(255,215,0,0.3);
      min-width: 400px;
    }

    .lobby h2 {
      color: #ffe868;
      margin-bottom: 30px;
      font-size: 2.5rem;
      font-family: 'Antaresia', Arial, sans-serif;
      font-weight: 700;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
      letter-spacing: 2px;
    }

    .lobby input {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      border: 2px solid #d3c577;
      border-radius: 10px;
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 1.1rem;
      font-family: 'Luxembourg', Arial, sans-serif;
    }

    .lobby input::placeholder {
      color: rgba(255,255,255,0.7);
    }

    .lobby button {
      background: linear-gradient(135deg, #53d253 0%, #32CD32 100%);
      color: white;
      border: 2px solid #d3c577;
      padding: 15px 30px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.2rem;
      font-weight: 600;
      transition: all 0.3s ease;
      font-family: 'Luxembourg', Arial, sans-serif;
      letter-spacing: 1px;
      margin: 10px;
      width: 200px;
    }

    .lobby button:hover {
      background: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .lobby button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .game-code {
      background: rgba(255,255,255,0.1);
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      font-size: 1.3rem;
      letter-spacing: 2px;
      color: #FFD700;
      border: 2px solid #FFD700;
    }

    /* Health bars moved to top left corner */
    .health-info {
      position: absolute;
      top: 40px;
      left: 40px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      z-index: 10;
    }

    .player-info {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .player-section {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .player-top {
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
    }

    .player-bottom {
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
    }

    .player-label {
      color: #e6e274;
      font-weight: 600;
      font-size: 1.1rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      font-family: 'Luxembourg', Arial, sans-serif;
      letter-spacing: 1px;
      margin-bottom: 5px;
    }

    .health-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .health-bar {
      background: #444;
      height: 15px;
      width: 180px;
      border-radius: 10px;
      overflow: hidden;
      border: 2px solid #666;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    .health {
      height: 70%;
      background: linear-gradient(90deg, #ff0000 0%, #ff6600 50%, #00ff00 100%);
      width: 60%;
      transition: width 0.5s ease;
      box-shadow: 0 0 10px rgba(0,255,0,0.5);
    }

    .health-text {
      color: #f1e182;
      font-weight: 600;
      min-width: 50px;
      text-align: center;
      font-family: 'Luxembourg', Arial, sans-serif;
      font-size: 0.9rem;
    }

    .card-hand {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .opponent-cards {
      margin-top: 8px;
    }

    /* Reduced card size */
    .card {
      width: 100px;
      height: 150px;
      perspective: 1000px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .card:hover {
      transform: translateY(-10px);
    }

    .card.disabled {
      pointer-events: none;
      opacity: 0.6;
    }

    .card-content {
      width: 100%;
      height: 100%;
      position: relative;
      transition: transform 0.8s;
      transform-style: preserve-3d;
    }

    .card:hover .card-content:not(.flipped) {
      transform: rotateY(180deg);
    }

    .flipped .card-content {
      transform: rotateY(180deg);
    }

    .card-face {
      width: 100%;
      height: 100%;
      position: absolute;
      border-radius: 8px;
      backface-visibility: hidden;
      border: 2px solid #f0e6aa;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      background-size: cover;
      background-position: center;
    }

    .card-front {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 150"><rect width="100" height="150" fill="%23000080"/><text x="50" y="75" font-size="20" fill="white" text-anchor="middle" dominant-baseline="middle">CARD</text></svg>');
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .card-back.rock {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 150"><rect width="100" height="150" fill="%23654321"/><circle cx="50" cy="75" r="25" fill="%23888"/><text x="50" y="130" font-size="12" fill="white" text-anchor="middle">ROCK</text></svg>');
    }

    .card-back.paper {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 150"><rect width="100" height="150" fill="%23654321"/><rect x="25" y="50" width="50" height="50" fill="%23fff"/><text x="50" y="130" font-size="12" fill="white" text-anchor="middle">PAPER</text></svg>');
    }

    .card-back.scissors {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 150"><rect width="100" height="150" fill="%23654321"/><path d="M30 60 L50 75 L70 60 M30 90 L50 75 L70 90" stroke="%23silver" stroke-width="3" fill="none"/><text x="50" y="130" font-size="12" fill="white" text-anchor="middle">SCISSORS</text></svg>');
    }

    .arena {
      position: absolute;
      width: 280px;
      height: 200px;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      justify-content: space-around;
      background: rgba(0,0,0,0.3);
      border-radius: 20px;
      border: 2px solid #ded187;
      padding: 20px;
      opacity: 40%;
    }

    /* Reduced arena card size */
    .arena-card {
      width: 80px;
      height: 120px;
      border-radius: 8px;
      border: 2px solid #fffcee;
      background-size: cover;
      background-position: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.5s ease;
    }

    .arena-card.show {
      opacity: 1;
      transform: scale(1);
    }

    .arena-card.rock {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 120"><rect width="80" height="120" fill="%23654321"/><circle cx="40" cy="60" r="20" fill="%23888"/></svg>');
    }

    .arena-card.paper {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 120"><rect width="80" height="120" fill="%23654321"/><rect x="20" y="40" width="40" height="40" fill="%23fff"/></svg>');
    }

    .arena-card.scissors {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 120"><rect width="80" height="120" fill="%23654321"/><path d="M24 48 L40 60 L56 48 M24 72 L40 60 L56 72" stroke="%23silver" stroke-width="2" fill="none"/></svg>');
    }

    .status {
      position: absolute;
      bottom: 30px;
      left: 10%;
      transform: translateX(-50%);
      font-size: 1.3rem;
      color: #d3bc37;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      text-align: center;
      min-height: 30px;
      font-family: 'Luxembourg', Arial, sans-serif;
      font-weight: 600;
    }

    .round-result {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 4rem;
      font-weight: 700;
      color: #FFD700;
      text-shadow: 1px 1px 1px #ffea72;
      font-family: 'Antaresia', Arial, sans-serif;
      opacity: 0;
      transition: opacity 0.5s ease;
      z-index: 1001;
      padding: 30px 50px;
      border-radius: 20px;
      letter-spacing: 3px;
    }

    .round-result.show {
      opacity: 1;
    }

    .game-over {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.95);
      padding: 50px;
      border-radius: 20px;
      border: 3px solid #FFD700;
      text-align: center;
      z-index: 1002;
      box-shadow: 0 0 50px rgba(255,215,0,0.3);
    }

    .game-over h2 {
      color: #ffe868;
      margin-bottom: 20px;
      font-size: 3rem;
      font-family: 'Antaresia', Arial, sans-serif;
      font-weight: 700;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
      letter-spacing: 2px;
    }

    .game-over p {
      font-family: 'Luxembourg', Arial, sans-serif;
      font-size: 1.3rem;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .restart-btn {
      background: linear-gradient(135deg, #53d253 0%, #32CD32 100%);
      color: white;
      border: 2px solid #d3c577;
      padding: 15px 30px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.2rem;
      font-weight: 600;
      transition: all 0.3s ease;
      font-family: 'Luxembourg', Arial, sans-serif;
      letter-spacing: 1px;
    }

    .restart-btn:hover {
      background: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    /* Opponent cards always show back */
    .opponent-cards .card-content {
      transform: rotateY(0deg) !important;
    }

    .opponent-cards .card:hover .card-content {
      transform: rotateY(0deg) !important;
    }

    .waiting-indicator {
      position: absolute;
      top: 50%;
      right: 40px;
      transform: translateY(-50%);
      background: rgba(255,215,0,0.2);
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #FFD700;
      color: #FFD700;
      font-weight: 600;
    }

    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Lobby Screen -->
  <div class="lobby" id="lobby">
    <h2>rock paper scissors</h2>
    <div id="lobby-content">
      <input type="text" id="player-name" placeholder="Enter your name" maxlength="20">
      <div>
        <button id="create-game-btn">Create Game</button>
        <button id="join-game-btn">Join Game</button>
      </div>
      <div id="join-section" class="hidden">
        <input type="text" id="game-code-input" placeholder="Enter game code" maxlength="6">
        <button id="join-btn">Join</button>
      </div>
      <div id="waiting-section" class="hidden">
        <div class="game-code">Game Code: <span id="display-code"></span></div>
        <p>Waiting for opponent to join...</p>
      </div>
    </div>
  </div>

  <div class="poker-table">
    
    <!-- Health info moved to top left corner -->
    <div class="health-info">
      <div class="player-info">
        <div class="player-label" id="opponent-label">Opponent</div>
        <div class="health-container">
          <div class="health-text" id="opponent-health-text">100</div>
          <div class="health-bar">
            <div class="health" id="opponent-health"></div>
          </div>
        </div>
      </div>
      
      <div class="player-info">
        <div class="player-label" id="player-label">You</div>
        <div class="health-container">
          <div class="health-text" id="player-health-text">100</div>
          <div class="health-bar">
            <div class="health" id="player-health"></div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Opponent Player (Top) -->
    <div class="player-section player-top">
      <div class="card-hand opponent-cards">
        <div class="card">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back rock"></div>
          </div>
        </div>
        <div class="card">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back paper"></div>
          </div>
        </div>
        <div class="card">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back scissors"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Arena -->
    <div class="arena">
      <div class="arena-card" id="player-arena-card"></div>
      <div class="arena-card" id="opponent-arena-card"></div>
    </div>

    <!-- Round Result Display -->
    <div class="round-result" id="round-result"></div>

    <!-- Waiting Indicator -->
    <div class="waiting-indicator hidden" id="waiting-indicator">
      Waiting for opponent...
    </div>

    <!-- Human Player (Bottom) -->
    <div class="player-section player-bottom">
      <div class="card-hand">
        <div class="card player-card" data-value="rock">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back rock"></div>
          </div>
        </div>
        <div class="card player-card" data-value="paper">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back paper"></div>
          </div>
        </div>
        <div class="card player-card" data-value="scissors">
          <div class="card-content">
            <div class="card-face card-front"></div>
            <div class="card-face card-back scissors"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="status" id="status">Waiting to start game...</div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <script>
    // Firebase configuration - Replace with your own config
  const firebaseConfig = {
  apiKey: "AIzaSyDuW4yHg-NRa6B8o78mE6M0vkiZESMvBrQ",
  authDomain: "rpsgame-b2c51.firebaseapp.com",
  databaseURL: "https://rpsgame-b2c51-default-rtdb.firebaseio.com",
  projectId: "rpsgame-b2c51",
  storageBucket: "rpsgame-b2c51.appspot.com",
  messagingSenderId: "545614744833",
  appId: "1:545614744833:web:786faca1a9b03ae9e71f00",
  measurementId: "G-XNK7DWSTHY"
};


    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    class MultiplayerRPSGame {
      constructor() {
        this.gameCode = null;
        this.playerId = null;
        this.playerName = '';
        this.isHost = false;
        this.gameRef = null;
        this.playerHealth = 100;
        this.opponentHealth = 100;
        this.gameOver = false;
        this.waitingForOpponent = false;
        
        // DOM elements
        this.lobby = document.getElementById('lobby');
        this.playerCards = document.querySelectorAll('.player-card');
        this.status = document.getElementById('status');
        this.playerArenaCard = document.getElementById('player-arena-card');
        this.opponentArenaCard = document.getElementById('opponent-arena-card');
        this.roundResult = document.getElementById('round-result');
        this.waitingIndicator = document.getElementById('waiting-indicator');
        
        this.moves = ['rock', 'paper', 'scissors'];
        this.initLobby();
      }

      initLobby() {
        document.getElementById('create-game-btn').addEventListener('click', () => this.createGame());
        document.getElementById('join-game-btn').addEventListener('click', () => this.showJoinSection());
        document.getElementById('join-btn').addEventListener('click', () => this.joinGame());
        
        // Generate unique player ID
        this.playerId = 'player_' + Math.random().toString(36).substr(2, 9);
      }

      generateGameCode() {
        return Math.random().toString(36).substr(2, 6).toUpperCase();
      }

      async createGame() {
        this.playerName = document.getElementById('player-name').value.trim();
        if (!this.playerName) {
          alert('Please enter your name');
          return;
        }

        this.gameCode = this.generateGameCode();
        this.isHost = true;
        
        try {
          this.gameRef = database.ref('games/' + this.gameCode);
          
          await this.gameRef.set({
            host: {
              id: this.playerId,
              name: this.playerName,
              health: 100,
              move: null,
              ready: false
            },
            guest: null,
            gameState: 'waiting',
            round: 0,
            lastRoundResult: null
          });

          this.showWaitingScreen();
          this.listenForGameChanges();
        } catch (error) {
          console.error('Error creating game:', error);
          alert('Failed to create game. Please check your Firebase configuration.');
        }
      }

      showJoinSection() {
        document.getElementById('join-section').classList.remove('hidden');
      }

      async joinGame() {
        this.playerName = document.getElementById('player-name').value.trim();
        const gameCode = document.getElementById('game-code-input').value.trim().toUpperCase();
        
        if (!this.playerName || !gameCode) {
          alert('Please enter your name and game code');
          return;
        }

        this.gameCode = gameCode;
        this.isHost = false;
        
        try {
          this.gameRef = database.ref('games/' + this.gameCode);
          
          // Check if game exists
          const snapshot = await this.gameRef.once('value');
          if (!snapshot.exists()) {
            alert('Game not found');
            return;
          }

          const gameData = snapshot.val();
          if (gameData.guest) {
            alert('Game is full');
            return;
          }

          // Join as guest
          await this.gameRef.update({
            guest: {
              id: this.playerId,
              name: this.playerName,
              health: 100,
              move: null,
              ready: false
            },
            gameState: 'playing'
          });

          this.startGame();
          this.listenForGameChanges();
        } catch (error) {
          console.error('Error joining game:', error);
          alert('Failed to join game. Please check the game code.');
        }
      }

      showWaitingScreen() {
        document.getElementById('lobby-content').innerHTML = `
          <div class="game-code">Game Code: ${this.gameCode}</div>
          <p>Waiting for opponent to join...</p>
        `;
      }

      startGame() {
        this.lobby.classList.add('hidden');
        this.initGame();
      }

      listenForGameChanges() {
        this.gameRef.on('value', (snapshot) => {
          const gameData = snapshot.val();
          if (!gameData) return;

          // Update opponent info
          const opponent = this.isHost ? gameData.guest : gameData.host;
          const player = this.isHost ? gameData.host : gameData.guest;

          if (opponent) {
            document.getElementById('opponent-label').textContent = opponent.name;
            this.opponentHealth = opponent.health;
            this.updateHealthDisplay();
          }

          if (player) {
            this.playerHealth = player.health;
            this.updateHealthDisplay();
          }

          // Check if both players joined
          if (gameData.gameState === 'playing' && gameData.host && gameData.guest && this.lobby && !this.lobby.classList.contains('hidden')) {
            this.startGame();
          }

          // Check for round results
          if (gameData.lastRoundResult && gameData.round > this.currentRound) {
            this.currentRound = gameData.round;
            this.processRoundResult(gameData.lastRoundResult);
          }

          // Check if both players made moves
          if (gameData.host && gameData.guest && gameData.host.move && gameData.guest.move && gameData.host.ready && gameData.guest.ready) {
            this.resolveRound(gameData);
          }

          // Check for game over
          if (gameData.gameState === 'finished') {
            this.handleGameOver(gameData);
          }
        });
      }

      initGame() {
        this.currentRound = 0;
        this.playerCards.forEach(card => {
          card.addEventListener('click', (e) => this.playRound(e));
        });
        this.updateHealthDisplay();
        this.status.textContent = "Choose your card to begin the duel!";
        document.getElementById('player-label').textContent = this.playerName;
      }

      async playRound(e) {
        if (this.gameOver || this.waitingForOpponent) return;
        
        const playerMove = e.currentTarget.dataset.value;
        this.waitingForOpponent = true;
        
        // Disable cards and show waiting
        this.setCardsEnabled(false);
        this.waitingIndicator.classList.remove('hidden');
        this.status.textContent = "Waiting for opponent's move...";
        
        // Update player's move in Firebase
        const playerPath = this.isHost ? 'host' : 'guest';
        await this.gameRef.child(playerPath).update({
          move: playerMove,
          ready: true
        });
      }

      async resolveRound(gameData) {
        if (this.isHost) {
          // Only host resolves the round to avoid conflicts
          const hostMove = gameData.host.move;
          const guestMove = gameData.guest.move;
          
          const result = this.determineWinner(hostMove, guestMove);
          
          let newHostHealth = gameData.host.health;
          let newGuestHealth = gameData.guest.health;
          
          if (result === 'host') {
            newGuestHealth = Math.max(0, newGuestHealth - 20);
          } else if (result === 'guest') {
            newHostHealth = Math.max(0, newHostHealth - 20);
          }
          
          const roundResult = {
            hostMove,
            guestMove,
            winner: result,
            hostHealth: newHostHealth,
            guestHealth: newGuestHealth
          };
          
          // Update game state
          await this.gameRef.update({
            'host/health': newHostHealth,
            'guest/health': newGuestHealth,
            'host/move': null,
            'guest/move': null,
            'host/ready': false,
            'guest/ready': false,
            lastRoundResult: roundResult,
            round: gameData.round + 1,
            gameState: (newHostHealth <= 0 || newGuestHealth <= 0) ? 'finished' : 'playing'
          });
        }
      }

      processRoundResult(result) {
        this.waitingForOpponent = false;
        this.waitingIndicator.classList.add('hidden');
        
        const playerMove = this.isHost ? result.hostMove : result.guestMove;
        const opponentMove = this.isHost ? result.guestMove : result.hostMove;
        
        // Show cards in arena
        this.showArenaCards(playerMove, opponentMove);
        
        setTimeout(() => {
          let roundResultText = '';
          let message = '';
          
          if (result.winner === 'draw') {
            message = `Draw! Both played ${playerMove}`;
            roundResultText = 'Draw';
          } else {
            const playerWon = (this.isHost && result.winner === 'host') || (!this.isHost && result.winner === 'guest');
            if (playerWon) {
              message = `You win! ${playerMove} beats ${opponentMove}`;
              roundResultText = 'Won';
            } else {
              message = `Opponent wins! ${opponentMove} beats ${playerMove}`;
              roundResultText = 'Lost';
            }
          }
          
          this.status.textContent = message;
          this.showRoundResult(roundResultText);
          this.updateHealthDisplay();
          
          setTimeout(() => {
            this.hideArenaCards();
            this.hideRoundResult();
            if (!this.gameOver) {
              this.setCardsEnabled(true);
              this.status.textContent = "Choose your next card!";
            }
          }, 2500);
        }, 1000);
      }

      showArenaCards(playerMove, opponentMove) {
        this.playerArenaCard.className = `arena-card ${playerMove}`;
        this.opponentArenaCard.className = `arena-card ${opponentMove}`;
        
        setTimeout(() => {
          this.playerArenaCard.classList.add('show');
          this.opponentArenaCard.classList.add('show');
        }, 100);
      }

      hideArenaCards() {
        this.playerArenaCard.classList.remove('show');
        this.opponentArenaCard.classList.remove('show');
        setTimeout(() => {
          this.playerArenaCard.className = 'arena-card';
          this.opponentArenaCard.className = 'arena-card';
        }, 500);
      }

      showRoundResult(text) {
        document.body.classList.add('blur-background');
        this.roundResult.textContent = text;
        this.roundResult.classList.add('show');
      }

      hideRoundResult() {
        document.body.classList.remove('blur-background');
        this.roundResult.classList.remove('show');
      }

      determineWinner(move1, move2) {
        if (move1 === move2) return 'draw';
        
        const winConditions = {
          rock: 'scissors',
          paper: 'rock',
          scissors: 'paper'
        };
        
        if (winConditions[move1] === move2) return 'host';
        return 'guest';
      }

      updateHealthDisplay() {
        document.getElementById('player-health').style.width = this.playerHealth + '%';
        document.getElementById('opponent-health').style.width = this.opponentHealth + '%';
        document.getElementById('player-health-text').textContent = this.playerHealth;
        document.getElementById('opponent-health-text').textContent = this.opponentHealth;
      }

      handleGameOver(gameData) {
        this.gameOver = true;
        const playerWon = (this.isHost && gameData.host.health > 0) || (!this.isHost && gameData.guest.health > 0);
        const winner = playerWon ? 'You Won The Match' : 'You Lost The Match';
        
        setTimeout(() => {
          this.showGameOver(winner);
        }, 1000);
      }

      showGameOver(winner) {
        document.body.classList.add('blur-background');
        const gameOverDiv = document.createElement('div');
        gameOverDiv.className = 'game-over';
        gameOverDiv.innerHTML = `
          <h2>${winner}</h2>
          <p>Final Score: You ${this.playerHealth} - ${this.opponentHealth} Opponent</p>
          <button class="restart-btn" onclick="location.reload()">Play Again</button>
        `;
        document.body.appendChild(gameOverDiv);
      }

      setCardsEnabled(enabled) {
        this.playerCards.forEach(card => {
          if (enabled) {
            card.classList.remove('disabled');
          } else {
            card.classList.add('disabled');
          }
        });
      }
    }

    // Start the game when page loads
    window.addEventListener('DOMContentLoaded', () => {
      new MultiplayerRPSGame();
    });
  </script>
</body>
</html>
